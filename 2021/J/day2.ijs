i  =. ;: > cutopen getin 21 2
c  =. ('forward';'down';'up')&i. {."1 i
X  =. ".@>@:{:"1 i
p1 =. ({. * -/@:}.) X +//.~ c
'f d u' =. X *"1 1 (=/~ ~.) c
p2 =. +/ f * +/ f * +/\ d - u
