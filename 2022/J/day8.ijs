arr =: "."0@> cutopen 22 getin 8
g =: {{(u"1&.|: v u&.|."1&.|: v u&.|."1 v u"1) y}}
f1 =: ({: > >./@:}:)\
f2 =: ({: (1 >. (+/ +  +./@:-.)@:>) >./\.@:}:)\
p1 =: +/ , (f1 g +.) arr
p2 =:>./ , (f2 g * ) arr
p1;p2
